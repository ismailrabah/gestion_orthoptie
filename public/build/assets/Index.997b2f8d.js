import{J as k}from"./JigLayout.473189ee.js";import{J as D}from"./ConfirmationModal.bfd904bd.js";import{J as C}from"./DialogModal.c74b5b77.js";import{I as x}from"./InertiaButton.b06aab18.js";import{J as $}from"./JigToggle.39822736.js";import{D as J,J as I}from"./DtComponent.f3ff127b.js";import{D as R}from"./DisplayMixin.328c366f.js";import N from"./ShowForm.8fb0c8b7.js";import{j as L,e as h,o as a,f as _,w as t,g as n,x as i,z as r,k as d,i as o,y as l,C as g}from"./vendor.bec00c62.js";import{J as P}from"./JigDd.6b7b5a1f.js";import{_ as S}from"./plugin-vue_export-helper.5a098b48.js";import"./ApplicationLogo.0294935d.js";import"./main.ebbf8bb3.js";import"./ShowForm.bc40c19e.js";import"./ShowForm.503bfef2.js";const B=L({name:"Index",components:{DtComponent:J,JigToggle:$,InertiaButton:x,JetConfirmationModal:D,JetDialogModal:C,JigModal:I,JigLayout:k,ShowConsultationsForm:N,JigDd:P},props:{can:Object,columns:Array,fichier:Object},inject:["$refreshDt","$dayjs"],data(){return{tableId:"consultations-dt",tableParams:{},datatable:null,confirmDelete:!1,currentModel:null,withDisabled:!1,showModal:!1,extends_info:!1}},mixins:[R],mounted(){},computed:{ajaxUrl(){const e=new URL(this.route("api.consultations.dt"));return this.fichier&&e.searchParams.append("fichier_id",this.fichier.id),e.href}},methods:{showModel(e){axios.get(route("api.consultations.show",e)).then(s=>{this.currentModel=s.data.payload,this.showModal=!0})},editModel(e){this.$inertia.visit(this.route("admin.consultations.edit",e.id))},manageModel(e){this.$inertia.visit(this.route("admin.consultations.manage",e.id))},expandInfo(){this.extends_info=!this.extends_info},confirmDeletion(e){this.currentModel=e,this.confirmDelete=!0},cancelDelete(){this.currentModel=!1,this.confirmDelete=!1},async deleteModel(){const e=this;this.confirmDelete=!1,this.currentModel&&this.$inertia.delete(route("admin.consultations.destroy",e.currentModel),{onFinish:s=>{this.displayNotification("success","Item deleted."),e.$refreshDt(e.tableId)},onError:s=>{console.log(s),this.displayNotification("error","There was an error while deleting the item.")}})},async toggleActivation(e,s){console.log(e),axios.put(route("api.consultations.update",s.id),{enabled:e}).then(u=>{this.displayNotification("success",u.data.message),this.$refreshDt(this.tableId)})},async printReport(e){await axios.get(this.route("api.consultations.print",{consultation_id:e.id}),{responseType:"blob"}).then(s=>{this.displayNotification("success","Consultation Report Printed");const u=new Blob([s.data],{type:"application/pdf"}),c=document.createElement("a");c.href=URL.createObjectURL(u),c.download="Consultation.pdf",c.click(),URL.revokeObjectURL(c.href)}).catch(s=>{var u,c;this.displayNotification("error",((c=(u=s.response)==null?void 0:u.data)==null?void 0:c.message)||s.message||s)}).finally(s=>{})}}}),U={class:"flex flex-wrap items-center justify-between w-full px-4"},A=n("i",{class:"fas fa-arrow-left"},null,-1),E=o(" Retour"),F={class:"flex gap-x-2"},T=n("i",{class:"fas fa-plus"},null,-1),O=o(" Nouveau Consultation"),V=n("i",{class:"fas fa-redo"},null,-1),z=o(" Refresh"),Y={key:0,class:"flex flex-wrap px-4"},W={class:"z-10 flex-auto bg-white md:rounded-md md:shadow-md"},q={class:"w-full p-4 mb-2 text-lg font-black sm:rounded-t-lg bg-primary-100"},G=n("i",{class:"mr-2 fas fa-bars"},null,-1),H=o(" List Des Consultations "),K={key:0,class:"inline-block"},Q={key:0,class:"fas fa-angle-down"},X={key:1,class:"fas fa-angle-up"},Z={key:0,class:"gap-4 p-4"},ee={key:0,class:"flex"},te=o("Nom:"),oe=o("Prenom:"),se={class:"flex"},ie=o("Phone:"),ne=o("Email:"),ae={class:"flex"},le=o("Cin:"),re=o("Ddn:"),de={class:"flex"},ce=o("Adresse:"),fe=o("Fichiers:"),he={class:"p-4"},ue=n("div",null,"Are you sure you want to delete this record?",-1),pe={class:"flex justify-end gap-x-2"},me=o("Cancel"),_e=o("Yes, Delete"),be={key:1},ge=o("Close"),we={key:1,class:"p-4 font-bold text-red-500 bg-red-100 rounded-md shadow-md"};function ye(e,s,u,c,Me,je){const b=h("inertia-link"),p=h("inertia-button"),f=h("jig-dd"),w=h("dt-component"),y=h("jet-confirmation-modal"),M=h("show-consultations-form"),j=h("jig-modal"),v=h("jig-layout");return a(),_(v,null,{header:t(()=>[n("div",U,[i(b,{href:e.route("admin.dashboard"),class:"text-xl font-black text-white"},{default:t(()=>[A,E]),_:1},8,["href"]),n("div",F,[e.can.create?(a(),_(p,{key:0,href:e.route("admin.consultations.create"),classes:"bg-green-100 hover:bg-green-200 text-primary"},{default:t(()=>[T,O]),_:1},8,["href"])):r("",!0),i(p,{onClick:s[0]||(s[0]=m=>e.$refreshDt(e.tableId)),classes:"bg-indigo-100 hover:bg-green-200 text-indigo"},{default:t(()=>[V,z]),_:1})])])]),default:t(()=>[e.can.viewAny?(a(),d("div",Y,[n("div",W,[n("h3",q,[G,H,e.fichier?(a(),d("div",K,[e.fichier.patient?(a(),_(b,{key:0,href:e.route("admin.patients.show",e.fichier.patient.id),class:"text-xl font-black text-primary"},{default:t(()=>[o(" : "+l(e.fichier.patient.title),1)]),_:1},8,["href"])):r("",!0),e.fichier.patient?(a(),d("button",{key:1,style:{"margin-top":"-5px"},type:"button",onClick:s[1]||(s[1]=m=>e.expandInfo()),class:"pl-2 pt-1 pb-1 pr-1 transition duration-150 ease-in-out"},[e.extends_info?r("",!0):(a(),d("i",Q)),e.extends_info?(a(),d("i",X)):r("",!0)])):r("",!0)])):r("",!0)]),e.fichier&&e.extends_info?(a(),d("dl",Z,[e.fichier.patient?(a(),d("div",ee,[i(f,{class:"flex-1"},{dt:t(()=>[te]),default:t(()=>[o(" "+l(e.fichier.patient.nom),1)]),_:1}),i(f,{class:"flex-1"},{dt:t(()=>[oe]),default:t(()=>[o(" "+l(e.fichier.patient.prenom),1)]),_:1})])):r("",!0),n("div",se,[i(f,{class:"flex-1"},{dt:t(()=>[ie]),default:t(()=>[o(" "+l(e.fichier.patient.phone),1)]),_:1}),i(f,{class:"flex-1"},{dt:t(()=>[ne]),default:t(()=>[o(" "+l(e.fichier.patient.email),1)]),_:1})]),n("div",ae,[i(f,{class:"flex-1"},{dt:t(()=>[le]),default:t(()=>[o(" "+l(e.fichier.patient.cin),1)]),_:1}),i(f,{class:"flex-1"},{dt:t(()=>[re]),default:t(()=>[o(" "+l(e.fichier.patient.ddn),1)]),_:1})]),n("div",de,[i(f,{class:"flex-1"},{dt:t(()=>[ce]),default:t(()=>[o(" "+l(e.fichier.patient.adresse),1)]),_:1}),i(f,{class:"flex-1"},{dt:t(()=>[fe]),default:t(()=>[o(" "+l(e.fichier.patient.count_fichiers),1)]),_:1})])])):r("",!0),n("div",he,[i(w,{"table-id":e.tableId,"ajax-url":e.ajaxUrl,columns:e.columns,"ajax-params":e.tableParams,onShowModel:e.showModel,onEditModel:e.editModel,onDeleteModel:e.confirmDeletion,onManageModel:e.manageModel,onPrintReport:e.printReport},null,8,["table-id","ajax-url","columns","ajax-params","onShowModel","onEditModel","onDeleteModel","onManageModel","onPrintReport"])]),i(y,{title:"Confirm Deletion",show:e.confirmDelete},{content:t(()=>[ue]),footer:t(()=>[n("div",pe,[i(p,{as:"button",type:"button",onClick:g(e.cancelDelete,["stop"]),class:"bg-red-500"},{default:t(()=>[me]),_:1},8,["onClick"]),i(p,{as:"button",type:"button",onClick:g(e.deleteModel,["prevent"]),class:"bg-green-500"},{default:t(()=>[_e]),_:1},8,["onClick"])])]),_:1},8,["show"]),e.showModal&&e.currentModel?(a(),d("div",be,[i(j,{show:e.showModal,maxWidthClass:"max-w-7xl","corner-class":"rounded-lg","position-class":"align-middle",onClose:s[3]||(s[3]=m=>{e.currentModel=null,e.showModal=!1})},{title:t(()=>[o("Show Consultation #"+l(e.currentModel.id),1)]),footer:t(()=>[i(p,{class:"px-4 text-white bg-primary",onClick:s[2]||(s[2]=m=>{e.showModal=!1,e.currentModel=null})},{default:t(()=>[ge]),_:1})]),default:t(()=>[i(M,{model:e.currentModel},null,8,["model"])]),_:1},8,["show"])])):r("",!0)])])):(a(),d("div",we," You are not authorized to view a list of Consultations "))]),_:1})}var Ae=S(B,[["render",ye]]);export{Ae as default};
