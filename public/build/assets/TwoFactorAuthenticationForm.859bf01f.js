import{J as F}from"./ActionSection.f387ca65.js";import{J as v}from"./Button.b545a8dd.js";import{J}from"./DialogModal.a90c0402.js";import{J as P}from"./Input.12512e43.js";import{J as T}from"./InputError.ef575259.js";import{J as x}from"./SecondaryButton.78087a61.js";import{r as c,o as s,e as i,a,g as S,l as n,w as o,b as d,t as p,U as R,n as C,c as b,m as f,F as A,p as B}from"./main.8d02089a.js";import{_ as k}from"./plugin-vue_export-helper.21dcd24c.js";import{J as E}from"./DangerButton.e90cb3d0.js";import"./SectionTitle.56265092.js";import"./index.a8a3989e.js";const M={emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{JetButton:v,JetDialogModal:J,JetInput:P,JetInputError:T,JetSecondaryButton:x},data(){return{confirmingPassword:!1,form:{password:"",error:""}}},methods:{startConfirmingPassword(){axios.get(route("password.confirmation")).then(r=>{r.data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout(()=>this.$refs.password.focus(),250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(()=>{this.form.processing=!1,this.closeModal(),this.$nextTick(()=>this.$emit("confirmed"))}).catch(r=>{this.form.processing=!1,this.form.error=r.response.data.errors.password[0],this.$refs.password.focus()})},closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}}},V={class:"mt-4"},q=d(" Cancel ");function D(r,u,_,j,e,t){const w=c("jet-input"),l=c("jet-input-error"),h=c("jet-secondary-button"),g=c("jet-button"),y=c("jet-dialog-modal");return s(),i("span",null,[a("span",{onClick:u[0]||(u[0]=(...m)=>t.startConfirmingPassword&&t.startConfirmingPassword(...m))},[S(r.$slots,"default")]),n(y,{show:e.confirmingPassword,onClose:t.closeModal},{title:o(()=>[d(p(_.title),1)]),content:o(()=>[d(p(_.content)+" ",1),a("div",V,[n(w,{type:"password",class:"mt-1 block w-3/4",placeholder:"Password",ref:"password",modelValue:e.form.password,"onUpdate:modelValue":u[1]||(u[1]=m=>e.form.password=m),onKeyup:R(t.confirmPassword,["enter"])},null,8,["modelValue","onKeyup"]),n(l,{message:e.form.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[n(h,{onClick:t.closeModal},{default:o(()=>[q]),_:1},8,["onClick"]),n(g,{class:C(["ml-2",{"opacity-25":e.form.processing}]),onClick:t.confirmPassword,disabled:e.form.processing},{default:o(()=>[d(p(_.button),1)]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show","onClose"])])}var N=k(M,[["render",D]]);const K={components:{JetActionSection:F,JetButton:v,JetConfirmsPassword:N,JetDangerButton:E,JetSecondaryButton:x},data(){return{enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}},methods:{enableTwoFactorAuthentication(){this.enabling=!0,this.$inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([this.showQrCode(),this.showRecoveryCodes()]),onFinish:()=>this.enabling=!1})},showQrCode(){return axios.get("/user/two-factor-qr-code").then(r=>{this.qrCode=r.data.svg})},showRecoveryCodes(){return axios.get("/user/two-factor-recovery-codes").then(r=>{this.recoveryCodes=r.data})},regenerateRecoveryCodes(){axios.post("/user/two-factor-recovery-codes").then(r=>{this.showRecoveryCodes()})},disableTwoFactorAuthentication(){this.disabling=!0,this.$inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>this.disabling=!1})}},computed:{twoFactorEnabled(){return!this.enabling&&this.$page.props.user.two_factor_enabled}}},L=d(" Two Factor Authentication "),Q=d(" Add additional security to your account using two factor authentication. "),Y={key:0,class:"text-lg font-medium text-gray-900"},H={key:1,class:"text-lg font-medium text-gray-900"},I=a("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[a("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),U={key:2},z={key:0},G=a("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[a("p",{class:"font-semibold"}," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),W=["innerHTML"],O={key:1},X=a("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[a("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),Z={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},$={class:"mt-5"},ee={key:0},oe=d(" Enable "),te={key:1},se=d(" Regenerate Recovery Codes "),re=d(" Show Recovery Codes "),ne=d(" Disable ");function ae(r,u,_,j,e,t){const w=c("jet-button"),l=c("jet-confirms-password"),h=c("jet-secondary-button"),g=c("jet-danger-button"),y=c("jet-action-section");return s(),b(y,null,{title:o(()=>[L]),description:o(()=>[Q]),content:o(()=>[t.twoFactorEnabled?(s(),i("h3",Y," You have enabled two factor authentication. ")):(s(),i("h3",H," You have not enabled two factor authentication. ")),I,t.twoFactorEnabled?(s(),i("div",U,[e.qrCode?(s(),i("div",z,[G,a("div",{class:"mt-4",innerHTML:e.qrCode},null,8,W)])):f("",!0),e.recoveryCodes.length>0?(s(),i("div",O,[X,a("div",Z,[(s(!0),i(A,null,B(e.recoveryCodes,m=>(s(),i("div",{key:m},p(m),1))),128))])])):f("",!0)])):f("",!0),a("div",$,[t.twoFactorEnabled?(s(),i("div",te,[n(l,{onConfirmed:t.regenerateRecoveryCodes},{default:o(()=>[e.recoveryCodes.length>0?(s(),b(h,{key:0,class:"mr-3"},{default:o(()=>[se]),_:1})):f("",!0)]),_:1},8,["onConfirmed"]),n(l,{onConfirmed:t.showRecoveryCodes},{default:o(()=>[e.recoveryCodes.length===0?(s(),b(h,{key:0,class:"mr-3"},{default:o(()=>[re]),_:1})):f("",!0)]),_:1},8,["onConfirmed"]),n(l,{onConfirmed:t.disableTwoFactorAuthentication},{default:o(()=>[n(g,{class:C({"opacity-25":e.disabling}),disabled:e.disabling},{default:o(()=>[ne]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])])):(s(),i("div",ee,[n(l,{onConfirmed:t.enableTwoFactorAuthentication},{default:o(()=>[n(w,{type:"button",class:C({"opacity-25":e.enabling}),disabled:e.enabling},{default:o(()=>[oe]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])]))])]),_:1})}var ge=k(K,[["render",ae]]);export{ge as default};
